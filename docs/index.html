<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Spectral Integral Suite in C++: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen0.css" rel="stylesheet" type="text/css"/>
<link href="tabs_mine.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Spectral Integral Suite in C++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Spectral Integral Suite in C++ Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Written by Gokul Hariharan, <a href="#" onclick="location.href='mai'+'lto:'+'har'+'ih'+'020'+'@u'+'mn.'+'ed'+'u'; return false;">harih<span style="display: none;">.nosp@m.</span>020@<span style="display: none;">.nosp@m.</span>umn.e<span style="display: none;">.nosp@m.</span>du</a>.</p>
<h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>Spectral integration suite in C++ (SISC++) is a generic header to solve two-point boundary-value problems in the system representation. SISC++ can solve for linear differential equations, and compute eigenvalues, singular values of frequency responses, and the power spectral density (Hilbert-Schmidt norm) of linear differential systems.</p>
<p>This project was intended to create programs for direct numerical simulations of viscoelastic channel flows, then we extended this as a generic solver, following in the lines of Chebfun, see <a href="http://www.chebfun.org/">http://www.chebfun.org/</a>. Chebfun is based on Matlab for which you need to purchase a license.</p>
<p>SISC++ aims to provide a Chebfun-like interface in C++. Just as Chebfun overloads functions and operations on linear matrices to differential operators, SISC++ uses <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen's </a> matrix representation in C++ for linear differential operators. For instance, one would input a normal matrix using <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a> in the following manner, </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span>Eigen;</div><div class="line">MatrixXd A(2,2);</div><div class="line">A &lt;&lt; 1, 2, <span class="comment">//</span></div><div class="line">     3, 4;</div></div><!-- fragment --><p> In SISC++, you can overload the linear block-matrix operator </p><p class="formulaDsp">
\begin{align} L = \left[ \begin{array}{cc} \partial_y &amp; y \\ y\,\partial_{yy} &amp; \partial_{yy}/2 \end{array} \right],\nonumber \end{align}
</p>
<p> as </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacesis.html">sis</a>;</div><div class="line">valarray&lt;double&gt; <a class="code" href="namespacesis.html#a55b489afa593b0e9c014a92c5bfeabce">y</a>;</div><div class="line"><a class="code" href="namespacesis.html#aac9f3764ef4b009372147ff563d994e8">setChebPts</a>(<a class="code" href="namespacesis.html#a55b489afa593b0e9c014a92c5bfeabce">y</a>);</div><div class="line"><a class="code" href="classsis_1_1Linop.html">Linop &lt;double&gt;</a> Dy(1), Dyy(2);</div><div class="line">Dy.coef &lt;&lt; 1.0, 0.0;</div><div class="line">Dyy.coef &lt;&lt; 1.0, 0.0, 0.0;</div><div class="line"><a class="code" href="classsis_1_1LinopMat.html">LinopMat&lt;double&gt;</a> L(2,2);</div><div class="line">L &lt;&lt; Dy, <a class="code" href="namespacesis.html#a55b489afa593b0e9c014a92c5bfeabce">y</a>,<span class="comment">//</span></div><div class="line">     <a class="code" href="namespacesis.html#a55b489afa593b0e9c014a92c5bfeabce">y</a>*Dyy, Dyy/2.0;</div></div><!-- fragment --><p> Following that, just as you can use the EigenSolver in <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a> for matrix eigenvalues, you can use EigenSolver in SISC++ for linear block-matrix operators. <br />
 <br />
 An advantage with a code in C++ is you do not need a Matlab license to use it. You can also optimize a code in C++ for speed by using proprietary compilers like the Intel / Cray compilers.</p>
<p>One major difference from Chebfun is that we do not provide for automatic collocation. Automatic collocation is a useful utility in Chebfun that keeps increasing the number of basis functions until the solution reaches machine precision. We did not incorporate this as automatic collocation adds to the computational expense, which is a liability for direct numerical simulations.</p>
<p>For most part, classes and functions are quite intuitive, but you need to know a bit about C++. A good place to learn C++ is <a href="http://www.cplusplus.com/doc/tutorial/">here </a>. You should feel comfortable using SISC++ if you have already used <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a>. As far as the algorithm is concerned, SISC++ is based on the recent spectral integration method by Du, <a class="el" href="citelist.html#CITEREF_DuSI">[2]</a> , which is a well-conditioned method, compared to conventional spectral-collocation / Tau methods. Chebfun too has a well-conditioned scheme, the ultraspherical discretization <a class="el" href="citelist.html#CITEREF_UltraS">[4]</a>. <br />
 <br />
 An advantage of SISC++ compared to Chebfun is that incompressible hydrodynamic eigenvalue and singular value problems for Newtonian and Viscoelastic fluids can be solved for in both, primitive variables and in the evolution form. To the best of our knowledge, Chebfun can only be used after recasting hydrodynamic problems to the evolution form. As a virtue of spectral integration, SISC++ can solve for incompressible flow eigenvalue problems directly in the discriptor form (in primitive variables). Using the primitive variable formulation can potentially save time involving algebraic transformations, particularly in complex fluids.</p>
<p>In addition, we also provide tools to handle eigenvalue boundary constraints (problems where the eigenvalue appears in the boundary conditions), for eigenvalue problems involving fluid-fluid interfaces.</p>
<h1><a class="anchor" id="Prerequisites"></a>
Prerequisites</h1>
<p>SISC++ requires two free libraries to be pre-installed,</p><ol type="1">
<li>Intel MKL (<a href="https://software.intel.com/en-us/mkl/choose-download">https://software.intel.com/en-us/mkl/choose-download</a>) and</li>
<li>Eigen (<a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">http://eigen.tuxfamily.org/index.php?title=Main_Page</a>)</li>
</ol>
<p>We strogly recommend downloading these from the respective websites and installing them. For <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a> in specific, we ask that Mac users refrain from using brew to install either of these. Of course, if the user is familiar about linking these libraries correctly while using C++, then the method of installing these libraries should not matter.</p>
<p>You must also set the path for Intel MKL. For linux, you can do this by saying </p><div class="fragment"><div class="line">source  /opt/intel/compilers_and_libraries_2019/linux/mkl/bin/mklvars.sh</div><div class="line">intel64 </div></div><!-- fragment --><p> <b>in every new terminal</b>. Else, you can add this to you ~/.bashrc file. For other platforms, take a look at setting environment variables <a href="https://software.intel.com/en-us/articles/intel-math-kernel-library-intel-mkl-2019-getting-started">here.</a></p>
<p>No part of SISC++ uses anything that is OS specific. However, I have not tried using it on Windows. I use it regularly on Mac and Linux.</p>
<p>Most routines in SISC++ use default <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen's </a>routines for eigenvalue problems. At the time of writing this program, <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a> does not have an eigenvalue solver for complex generalized systems, of the form \( L\,\phi= \lambda \, M \, \phi\). As SISC++ uses a well-conditioned discretization, in most cases both \(L\) and \(M\) are well conditioned, so either can be inverted while the other is singular to compute the eigenvalues.</p>
<p>We provide an option to use the macro SIS_USE_LAPACK. This will use LAPACK's complex generalized eigenvalue solver and also replace all other places of the codes with LAPACK's counter-part. Intel MKL also has LAPACK in it, so if you have linked Intel MKL correctly, LAPACK must be available in the same path as Intel MKL (you will not have to do anything extra). However, as we use fortran code in C++, gfortran needs to be linked during compilation (implying that gfortran must be installed, in Mac say "brew install gfortran", and in linux "sudo apt-get install gfortran" in the terminal). In summary, if you need to use SIS_USE_LAPACK, make sure that gfortran is installed.</p>
<h1><a class="anchor" id="Installation"></a>
Installation</h1>
<p>SISC++ does not need any installation and can be directly used as a header. You can copy <a class="el" href="sis_8hpp.html">sis.hpp</a> file into /usr/local/includes/ in either Mac or Linux, as this is a default search path for most C++ compilers.</p>
<h1><a class="anchor" id="secgets"></a>
Getting Started</h1>
<p>If <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen </a> and Intel MKL are installed in their default locations, then you can begin by creating two folders, named bin and data. Then open a terminal in the current folder and say</p><div class="fragment"><div class="line">make all </div></div><!-- fragment --><p> This will compile all the examples in the directory examples, and the executables will be placed in the directory bin. Then run the executables, by saying, say </p><div class="fragment"><div class="line">./bin/Ex_01</div></div><!-- fragment --><p> in the terminal. Data generated will be placed in the folder data. To solve your own problems, go through the examples and modify them. </p>
<h1><a class="anchor" id="citeus"></a>
Cite Us</h1>
<p>If you use this work in your research or teaching, please cite us: </p><div class="fragment"><div class="line">@article{harkumjovJCP20,</div><div class="line">author  = {G. Hariharan and S. Kumar and M. R. Jovanovi\&#39;c},</div><div class="line">title   = {Well-conditioned ultraspherical and spectral integration methods for</div><div class="line">resolvent analysis of channel flows of {N}ewtonian and viscoelastic fluids},</div><div class="line">journal = {J. Comput. Phys.},</div><div class="line">year    = {2020},</div><div class="line">note    = {submitted; also arXiv:2005.04493},</div><div class="line">pdf     = {https://arxiv.org/abs/2005.04493}</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
